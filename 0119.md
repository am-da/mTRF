






最良の相関係数を求める。(交差検証なし)
<details><summary>コード</summary>
  
```python
import numpy as np
import matplotlib.pyplot as plt

# 試行するtminとtmaxの範囲を指定
tmin_range = np.linspace(-0.3, -0.01, 100)
tmax_range = np.linspace(0.01, 0.3, 100)

best_corrcoef = -1  # 最良の相関係数を初期化
best_tmin = None
best_tmax = None

# モデル用にデータを準備。faceデータを転置し、モデルの出力データ(EEG)Yを取得。
face = face.T
Y, _ = raw[:] 
Y = Y.T
coefs = np.zeros((n_splits, n_channels, n_delays))
scores = np.zeros((n_splits, n_channels))

# 各tminとtmaxの組み合わせに対して相関係数を計算
for tmax in tmax_range:
    for tmin in tmin_range:
        rf = ReceptiveField(tmin, tmax, sfreq, feature_names=["envelope"], estimator=1.0, scoring="corrcoef")
        n_delays = int((tmax - tmin) * sfreq) + 2
        X_train = face[train][:, np.newaxis]
        rf.fit(X_train, Y[train])
        X_test = face[test][:, np.newaxis]
        scores[ii] = rf.score(X_test, Y[test])
        coefs[ii] = (rf.coef_[:, 0, :])
        mean_scores = scores.mean(axis=0)
        if np.mean(mean_scores) > best_corrcoef:
          best_corrcoef = np.mean(mean_scores)
          best_tmin = tmin
          best_tmax = tmax

# 結果の出力
print(f"Best tmin: {best_tmin}, Best tmax: {best_tmax}, Best Correlation Coefficient: {best_corrcoef}")
```

```python
Best tmin: -0.3, Best tmax: 0.01, Best Correlation Coefficient: 0.0017133763718476859
```
</details>



最良の相関係数を求める。(交差検証あり)
<details><summary>コード</summary>
  
```python
import numpy as np
import matplotlib.pyplot as plt

# 試行するtminとtmaxの範囲を指定
tmin_range = np.linspace(-0.3, -0.01, 100)
tmax_range = np.linspace(0.01, 0.3, 100)

best_corrcoef = -1  # 最良の相関係数を初期化
best_tmin = None
best_tmax = None

# 交差検証のための分割数を設定し、KFoldクラスを初期化
n_splits = 3
cv = KFold(n_splits)

# モデル用にデータを準備。faceデータを転置し、モデルの出力データ(EEG)Yを取得。
face = face.T
Y, _ = raw[:] 
Y = Y.T

# 各tminとtmaxの組み合わせに対して相関係数を計算
for tmax in tmax_range:
    for tmin in tmin_range:
        rf = ReceptiveField(tmin, tmax, sfreq, feature_names=["envelope"], estimator=1.0, scoring="corrcoef")
        n_delays = int((tmax - tmin) * sfreq) + 2
        coefs = np.zeros((n_splits, n_channels, n_delays))
        scores = np.zeros((n_splits, n_channels))
        for ii, (train, test) in enumerate(cv.split(face)):
          X_train = face[train][:, np.newaxis]
          rf.fit(X_train, Y[train])
          X_test = face[test][:, np.newaxis]
          scores[ii] = rf.score(X_test, Y[test])
          coefs[ii] = (rf.coef_[:, 0, :])
        mean_scores = scores.mean(axis=0)
        if np.mean(mean_scores) > best_corrcoef:
          best_corrcoef = np.mean(mean_scores)
          best_tmin = tmin
          best_tmax = tmax

# 結果の出力
print(f"Best tmin: {best_tmin}, Best tmax: {best_tmax}, Best Correlation Coefficient: {best_corrcoef}")

```

```python
Best tmin: -0.3, Best tmax: 0.01, Best Correlation Coefficient: -0.01598082083947267

```

</details>

